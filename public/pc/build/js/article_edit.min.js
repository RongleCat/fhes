"use strict";$(function(){var e=window.wangEditor,t=["head","bold","fontSize","fontName","italic","underline","strikeThrough","foreColor","backColor","link","list","justify","quote","image","table","undo","redo"];layui.upload.render({elem:"#upload-cover",url:"/manage/uploadNewsCover",accept:"images",acceptMime:"image/*",done:function(e){200===e.ok&&(0!=$(".img-cover").length?$(".img-cover")[0].src=e.result.url+"-mask":$("#upload-cover").find("p").text("点击/拖拽更换封面图片").end().before('<img src="'+e.result.url+'-mask" class="img-cover">'))}});var o=new e("#zhContent");o.customConfig.onfocus=function(){$(o.toolbarSelector).addClass("focus")},o.customConfig.onblur=function(){$(o.toolbarSelector).removeClass("focus")},o.customConfig.menus=t;var a=new e("#enContent");a.customConfig.onfocus=function(){$(a.toolbarSelector).addClass("focus")},a.customConfig.onblur=function(){$(a.toolbarSelector).removeClass("focus")},a.customConfig.menus=t,o.create(),a.create(),uploadInit(o),uploadInit(a),layui.use("form",function(){var e=layui.form;e.on("submit(submit)",function(e){var t=o.txt.html(),l=a.txt.html(),n=$(".img-cover").attr("src");for(var i in e.field)e.field[i]||delete e.field[i];if(e.field.id=$(".img-cover").attr("data-id"),!n)return layer.msg("请先上传封面图片"),!1;if(e.field.cover=n,o.txt.text()&&(e.field.content=t),a.txt.text()&&(e.field.encontent=l),$("#openEn")[0].checked){if(!e.field.title&&!e.field.entitle)return layer.msg("中文标题和英文标题不能都为空"),!1;if(e.field.entitle&&!e.field.encontent)return layer.msg("有英文标题必须有英文内容"),!1;e.field.encontent&&(e.field.entitle||layer.msg("有英文内容必须有英文标题"))}else if(!e.field.title)return layer.msg("标题不能为空"),!1;return e.field.title&&!e.field.content?layer.msg("有中文标题必须有中文内容"):e.field.content&&!e.field.title?layer.msg("有中文内容必须有中文标题"):($("#openEn")[0].checked||(delete e.field.encontent,delete e.field.entitle,delete e.field.ensubtitle),e.field.title&&e.field.entitle?e.field.language="11":e.field.title&&!e.field.entitle?e.field.language="10":e.field.language="01",$.ajax({type:"POST",url:"/manage/editarticle",dataType:"json",data:e.field,success:function(e){200===e.ok?targetParent("articleList"):alert(e.msg)}})),!1}),e.on("switch(addEn)",function(e){e.elem.checked?$(".en-block").fadeIn("fast"):$(".en-block").fadeOut("fast")})})});