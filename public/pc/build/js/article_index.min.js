"use strict";$(function(){var e=layui.table,a=[1,1],l=[{field:"id",title:"ID",width:80},{field:"cover",title:"封面图片",width:130,templet:function(e){return'<img src="'+e.cover+'">'}},{field:"title",title:"中文标题"},{field:"entitle",title:"英文标题"},{field:"edittime",templet:function(e){return""+tools.dateFormat(new Date(e.edittime))},title:"编辑时间"},{fixed:"right",align:"center",title:"操作",templet:function(e){return'<a class="layui-btn '+("1"===e.home?"layui-btn-warm":"layui-btn-normal")+' layui-btn-xs" lay-event="home">'+("1"===e.home?"从首页删除":"添加到首页")+'</a>\n                <a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="detail">查看</a>\n                <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>\n                <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>'}}],i={url:"/manage/getArticleList",elem:"#demo",id:"demo",page:{curr:1},limit:10,limits:[10,15,20],height:"full-200",where:{},cols:[[].concat(l)]},n=[{field:"id",title:"ID",width:80},{field:"cover",title:"封面图片",width:130,templet:function(e){return'<img src="'+e.cover+'">'}},{field:"title",title:"中文标题"},{field:"edittime",templet:function(e){return""+tools.dateFormat(new Date(e.edittime))},title:"编辑时间"},{fixed:"right",align:"center",title:"操作",templet:function(e){return'<a class="layui-btn '+("1"===e.home?"layui-btn-warm":"layui-btn-normal")+' layui-btn-xs" lay-event="home">'+("1"===e.home?"从首页删除":"添加到首页")+'</a>\n                <a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="detail">查看</a>\n                <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>\n                <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>'}}],r=[{field:"id",title:"ID",width:80},{field:"cover",title:"封面图片",width:130,templet:function(e){return'<img src="'+e.cover+'">'}},{field:"entitle",title:"英文标题"},{field:"edittime",templet:function(e){return""+tools.dateFormat(new Date(e.edittime))},title:"编辑时间"},{fixed:"right",align:"center",title:"操作",templet:function(e){return'<a class="layui-btn '+("1"===e.home?"layui-btn-warm":"layui-btn-normal")+' layui-btn-xs" lay-event="home">'+("1"===e.home?"从首页删除":"添加到首页")+'</a>\n                <a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="detail">查看</a>\n                <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>\n                <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>'}}],o=e.render(i);$("#btn-search").on("click",function(e){var t=$("#ipt-keyword").val();i.where.keyword=t,o.reload(i)}),$("#btn-clear").on("click",function(e){delete i.where.keyword,delete i.where.language,a=[1,1],$(".layui-form-checkbox").addClass("layui-form-checked"),$('[type="checkbox"]').prop("checked",!0),i.cols[0]=l,o.reload(i)}),$("#ipt-keyword").on("keypress",function(e){13===e.keyCode&&$("#btn-search").click()}),layui.use("form",function(){layui.form.on("checkbox(lang)",function(e){var t=$(e.elem).attr("name");switch(e.elem.checked?"zh"===t?a[0]=1:a[1]=1:"zh"===t?a[0]=0:a[1]=0,i.where.language=a.join(""),i.where.language){case"10":i.cols[0]=n;break;case"01":i.cols[0]=r;break;default:i.cols[0]=l}o.reload(i)})}),e.on("tool(demo)",function(t){var a=t.data,e=t.event;t.tr;if("detail"===e)window.open("/news/"+a.id);else if("del"===e)layer.confirm("真的要删除这篇文章吗？",function(e){layer.close(e),$.ajax({type:"POST",url:"/manage/deletearticle",dataType:"json",data:{id:a.id},success:function(e){200===e.ok?t.del():alert(e.msg)}})});else if("edit"===e)window.location.href="/manage/editarticle/"+a.id;else if("home"===e){var l="1";"1"===a.home&&(l=""),$.ajax({type:"POST",url:"/manage/setHomeNews",dataType:"json",data:{id:a.id,state:l},success:function(e){200===e.ok?o.reload(i):alert(e.msg)}})}})});