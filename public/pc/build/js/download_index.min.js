'use strict';

$(function () {
    var _count = $('#page').data('count');
    var $list = $('.down-list');
    layui.use('laypage', function () {
        var laypage = layui.laypage;
        laypage.render({
            elem: 'page',
            count: parseInt(_count),
            limit: 10,
            jump: function jump(obj, first) {
                $.ajax({
                    type: "Get",
                    url: "/getDownFileList",
                    dataType: "json",
                    data: {
                        limit: obj.limit,
                        page: obj.curr
                    },
                    success: function success(r) {
                        if (r.ok === 200) {
                            console.log(r);
                            var html = '';
                            r.data.map(function (item, index) {
                                html += '<div class="item clearfix">\n                                    <svg class="icon" aria-hidden="true">\n                                        <use xlink:href="#icon-' + item.type + '"></use>\n                                    </svg>\n                                    <p>' + (item.lang === 'zh' ? item.title : item.entitle) + '</p>\n                                    <div class="right-box">\n                                        <span>' + item.size + '</span>\n                                        <a href="' + item.filepath + '?attname=" download>{{lang.download}}</a>\n                                    </div>\n                                </div>';
                            });
                            $list.empty().append(html);
                        } else {
                            alert(r.msg);
                        }
                    }
                });
            }
        });
    });
});